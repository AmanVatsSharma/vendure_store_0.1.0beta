"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7753],{394:function(e,r,n){n.d(r,{Yb:function(){return m},e2:function(){return g},fb:function(){return p},l0:function(){return h},n5:function(){return f},te:function(){return w}});var t=n(2729),s=n(1467),a=n(6829);function o(){let e=(0,t._)(["\n    width: 100%;\n    min-height: calc(100vh - 6rem);\n    flex-direction: column;\n    gap: 3.5rem;\n    justify-content: center;\n    align-items: center;\n\n    @media (max-width: ",") {\n        min-height: 60vh;\n    }\n"]);return o=function(){return e},e}function i(){let e=(0,t._)(["\n    position: relative;\n    padding: 5.5rem 7.5rem;\n    border-radius: ",";\n    box-shadow: 0 0 0.5rem ",";\n"]);return i=function(){return e},e}function c(){let e=(0,t._)(["\n    display: flex;\n    flex-direction: column;\n    gap: 2rem;\n    min-width: 27.5rem;\n    max-width: 27.5rem;\n"]);return c=function(){return e},e}function u(){let e=(0,t._)(["\n    position: absolute;\n    top: 0;\n    left: 0;\n    padding: 1rem;\n"]);return u=function(){return e},e}function l(){let e=(0,t._)(["\n    min-width: 32rem;\n    max-width: 40rem;\n"]);return l=function(){return e},e}function d(){let e=(0,t._)(["\n    min-height: calc(100vh - 10rem);\n    padding: 2rem 0;\n\n    @media (max-width: ",") {\n        flex-direction: column;\n    }\n"]);return d=function(){return e},e}let m=(0,a.Z)(s.K)(o(),e=>{let{theme:r}=e;return r.breakpoints.lg}),f=(0,a.Z)(s.K)(i(),e=>{let{theme:r}=e;return r.borderRadius},e=>{let{theme:r}=e;return r.shadow}),h=a.Z.form(c()),g=(0,a.Z)(s.K)(u()),p=(0,a.Z)(s.K)(l()),w=(0,a.Z)(s.K)(d(),e=>{let{theme:r}=e;return r.breakpoints.lg})},4639:function(e,r,n){n.d(r,{O:function(){return b}});var t=n(2729),s=n(5893),a=n(8297),o=n(1467),i=n(8081),c=n(9689),u=n(8803),l=n(7354),d=n(6062),m=n(6829),f=n(2951),h=n(7951),g=n(1163);function p(){let e=(0,t._)(["\n    position: absolute;\n    bottom: 0;\n    left: 0;\n    width: 100%;\n    height: 2px;\n    background-color: ",";\n"]);return p=function(){return e},e}function w(){let e=(0,t._)(["\n    width: fit-content;\n    margin-top: 2rem;\n    display: flex;\n    align-items: center;\n    text-transform: uppercase;\n\n    @media (min-width: ",") {\n        margin-top: 0;\n    }\n"]);return w=function(){return e},e}function x(){let e=(0,t._)(["\n    position: relative;\n    border: 1px solid ",";\n    padding: 1.6rem 2.4rem;\n    height: 100%;\n    &:hover {\n        & > p {\n            opacity: 0.7;\n        }\n    }\n    transition: opacity 0.3s ease-in;\n"]);return x=function(){return e},e}n(7294);let v=[{href:"/customer/manage",sub:[""],label:"navigation.manageAccount"},{href:"/customer/manage/addresses",sub:[""],label:"navigation.manageAddresses"},{href:"/customer/manage/orders",sub:["/customer/manage/orders/[code]"],label:"navigation.manageOrders"}],b=()=>{let e=(0,d.v)(),{t:r}=(0,h.$G)("customer"),{pathname:n}=(0,g.useRouter)(),t=(0,l.E4)(),a=async()=>{await (0,u.Zs)(e)({logout:{success:!0}}),t("/")},m=n.replace("/[channel]","");return(0,s.jsx)(P,{w100:!0,children:(0,s.jsxs)(o.K,{children:[v.map(e=>(0,s.jsx)(o.K,{column:!0,children:(0,s.jsxs)(y,{href:e.href,children:[(0,s.jsx)(i.TP,{children:r(e.label)}),(0,s.jsx)(j,{initial:{width:0},animate:{width:m===e.href||e.sub.includes(m)?"100%":"0%"},exit:{width:0},transition:{duration:.3}})]})},e.href)),(0,s.jsx)(c.zx,{onClick:a,children:(0,s.jsx)(i.TP,{upperCase:!0,color:"contrast",children:r("navigation.logout")})})]})})},j=(0,m.Z)(f.E.div)(p(),e=>e.theme.button.back),P=(0,m.Z)(o.K)(w(),e=>{let{theme:r}=e;return r.breakpoints.lg}),y=(0,m.Z)(a.r)(x(),e=>e.theme.gray(100))},7753:function(e,r,n){n.d(r,{o:function(){return S}});var t=n(5893),s=n(399),a=n(7294),o=n(4639),i=n(1467),c=n(8081),u=n(7951),l=n(1604),d=n(6312),m=n(7536),f=n(8803),h=n(1511),g=n(7354),p=n(2729),w=n(2951),x=n(9689),v=n(6829);function b(){let e=(0,p._)(["\n    align-items: flex-start;\n    display: flex;\n    width: 100%;\n    gap: 3.5rem;\n    @media (max-width: ",") {\n        flex-direction: column;\n    }\n"]);return b=function(){return e},e}function j(){let e=(0,p._)(["\n    display: flex;\n    flex-direction: column;\n    gap: 2rem;\n"]);return j=function(){return e},e}function P(){let e=(0,p._)(["\n    background: ",";\n    font-size: 1.2rem;\n"]);return P=function(){return e},e}let y=(0,v.Z)(w.E.div)(b(),e=>{let{theme:r}=e;return r.breakpoints.md}),N=v.Z.form(j()),_=(0,v.Z)(x.zx)(P(),e=>e.active&&e.theme.gray(700));var E=n(6062);let C=()=>{var e,r,n;let s=(0,E.v)(),a=(0,g.E4)(),{t:o}=(0,u.$G)("customer"),{t:c}=(0,u.$G)("common"),p=l.Ry({oldPassword:l.Z_().min(8,c("errors.password.minLength")).max(25,c("errors.password.maxLength")),newPassword:l.Z_().min(8,c("errors.password.minLength")).max(25,c("errors.password.maxLength")),newPasswordConfirmation:l.Z_().min(8,c("errors.password.minLength")).max(25,c("errors.password.maxLength"))}).refine(e=>e.newPassword===e.newPasswordConfirmation,{message:c("errors.confirmPassword.mustMatch"),path:["newPasswordConfirmation"]}).refine(e=>e.oldPassword!==e.newPassword,{message:c("errors.password.mustDifferent"),path:["newPassword"]}),{register:w,handleSubmit:x,setError:v,clearErrors:b,formState:{errors:j,isSubmitting:P}}=(0,m.cI)({values:{oldPassword:"",newPassword:"",newPasswordConfirmation:""},resolver:(0,d.F)(p)}),C=async e=>{try{let{updateCustomerPassword:r}=await (0,f.Zs)(s)({updateCustomerPassword:[{currentPassword:e.oldPassword,newPassword:e.newPassword},{__typename:!0,"...on InvalidCredentialsError":{message:!0,errorCode:!0,authenticationError:!0},"...on NativeAuthStrategyError":{errorCode:!0,message:!0},"...on PasswordValidationError":{errorCode:!0,message:!0,validationErrorMessage:!0},"...on Success":{success:!0}}]});if("Success"!==r.__typename){v("root",{message:c("errors.backend.".concat(r.errorCode))});return}let{logout:n}=await (0,f.Zs)(s)({logout:{success:!0}});n.success&&a("/customer/sign-in/")}catch(e){v("root",{message:c("errors.backend.UNKNOWN_ERROR")})}};return(0,t.jsx)(y,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{type:"spring",stiffness:380,damping:30},children:(0,t.jsxs)(N,{onSubmit:x(C),noValidate:!0,children:[(0,t.jsx)(h.jL,{error:{message:(null===(e=j.newPasswordConfirmation)||void 0===e?void 0:e.message)||(null===(r=j.root)||void 0===r?void 0:r.message)||(null===(n=j.newPassword)||void 0===n?void 0:n.message)},clearErrors:()=>b(["newPasswordConfirmation","newPassword"])}),(0,t.jsxs)(i.K,{gap:"2rem",column:!0,itemsCenter:!0,children:[(0,t.jsx)(h.II,{label:o("accountPage.passwordForm.oldPassword"),type:"password",...w("oldPassword")}),(0,t.jsxs)(i.K,{gap:"1.25rem",children:[(0,t.jsx)(h.II,{label:o("accountPage.passwordForm.newPassword"),type:"password",...w("newPassword")}),(0,t.jsx)(h.II,{label:o("accountPage.passwordForm.confirmPassword"),type:"password",...w("newPasswordConfirmation")})]})]}),(0,t.jsx)(_,{loading:P,type:"submit",children:o("accountPage.passwordForm.confirmPassword")})]})})};var Z=n(4979);let K=e=>{let{initialCustomer:r}=e,n=(0,E.v)(),{t:s}=(0,u.$G)("customer"),{t:o}=(0,u.$G)("common"),[c,g]=(0,a.useState)(r),[p,w]=(0,a.useState)(),x=l.Ry({firstName:l.Z_().min(1,{message:o("errors.firstName.required")}),lastName:l.Z_().min(1,{message:o("errors.lastName.required")}),phoneNumber:l.Z_().min(1,{message:o("errors.phoneNumber.required")}).optional()}),{register:v,handleSubmit:b,setError:j,formState:{errors:P,isSubmitting:C}}=(0,m.cI)({values:{addressEmail:null==c?void 0:c.emailAddress,firstName:(null==c?void 0:c.firstName)||"",lastName:(null==c?void 0:c.lastName)||"",phoneNumber:null==c?void 0:c.phoneNumber},resolver:(0,d.F)(x)}),K=async e=>{let{firstName:r,lastName:t,phoneNumber:a}=e,i=Object.entries(e).every(e=>{let[r,n]=e;return n===c[r]});if(!i)try{let{updateCustomer:e}=await (0,f.Zs)(n)({updateCustomer:[{input:{firstName:r,lastName:t,phoneNumber:a}},Z.iH]});if(!e){j("root",{message:o("errors.backend.UNKNOWN_ERROR")});return}g(r=>({...r,...e})),w(s("accountPage.detailsForm.successMessage"))}catch(e){j("root",{message:o("errors.backend.UNKNOWN_ERROR")})}};return(0,a.useEffect)(()=>{if(p){let e=setTimeout(()=>{w(void 0)},5e3);return()=>clearTimeout(e)}},[p]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.jL,{clearErrors:()=>w(void 0),success:{message:p}}),(0,t.jsx)(y,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{type:"spring",stiffness:380,damping:30},children:(0,t.jsxs)(N,{onSubmit:b(K),noValidate:!0,children:[(0,t.jsxs)(i.K,{gap:"2rem",column:!0,itemsCenter:!0,children:[(0,t.jsx)(h.II,{...v("addressEmail"),label:s("accountPage.detailsForm.addressEmail"),disabled:!0}),(0,t.jsxs)(i.K,{w100:!0,gap:"1.25rem",children:[(0,t.jsx)(h.II,{label:s("accountPage.detailsForm.firstName"),...v("firstName"),error:P.firstName}),(0,t.jsx)(h.II,{label:s("accountPage.detailsForm.lastName"),...v("lastName"),error:P.lastName})]}),(0,t.jsx)(h.II,{label:s("accountPage.detailsForm.phoneNumber"),...v("phoneNumber"),error:P.phoneNumber})]}),(0,t.jsx)(_,{loading:C,type:"submit",children:s("accountPage.detailsForm.changeDetails")})]})})]})};var k=n(1526);let I=e=>{let{initialCustomer:r}=e,{t:n}=(0,u.$G)("customer"),[s,o]=(0,a.useState)("details"),l=e=>o(e);return(0,t.jsxs)(i.K,{w100:!0,gap:"3.5rem",column:!0,children:[(0,t.jsxs)(i.K,{w100:!0,column:!0,gap:"1.5rem",children:[(0,t.jsx)(c.TP,{size:"2.5rem",weight:600,children:n("accountPage.title")}),(0,t.jsxs)(i.K,{gap:"0.5rem",children:[(0,t.jsx)(_,{active:"details"===s,onClick:()=>l("details"),children:n("accountPage.detailsForm.title")}),(0,t.jsx)(_,{active:"password"===s,onClick:()=>l("password"),children:n("accountPage.passwordForm.title")})]})]}),(0,t.jsx)(k.M,{children:"details"===s?(0,t.jsx)(K,{initialCustomer:r}):(0,t.jsx)(C,{})})]})};var F=n(2520),O=n(394),R=n(4597);let S=e=>{let{t:r}=(0,u.$G)("customer");return(0,t.jsx)(s.Ar,{categories:e.collections,navigation:e.navigation,pageTitle:r("accountPage.title"),children:(0,t.jsxs)(F.O,{children:[(0,t.jsx)(R.Kq,{w100:!0,justifyEnd:!0,children:(0,t.jsx)(o.O,{})}),(0,t.jsx)(O.te,{itemsStart:!0,w100:!0,gap:"3rem",children:(0,t.jsx)(I,{initialCustomer:e.activeCustomer})})]})})}},6312:function(e,r,n){n.d(r,{F:function(){return l}});var t=n(7536),s=function(e,r,n){if(e&&"reportValidity"in e){var s=(0,t.U2)(n,r);e.setCustomValidity(s&&s.message||""),e.reportValidity()}},a=function(e,r){var n=function(n){var t=r.fields[n];t&&t.ref&&"reportValidity"in t.ref?s(t.ref,n,e):t.refs&&t.refs.forEach(function(r){return s(r,n,e)})};for(var t in r.fields)n(t)},o=function(e,r){r.shouldUseNativeValidation&&a(e,r);var n={};for(var s in e){var o=(0,t.U2)(r.fields,s),u=Object.assign(e[s]||{},{ref:o&&o.ref});if(c(r.names||Object.keys(e),s)){var l=Object.assign({},i((0,t.U2)(n,s)));(0,t.t8)(l,"root",u),(0,t.t8)(n,s,l)}else(0,t.t8)(n,s,u)}return n},i=function(e){return Array.isArray(e)?e.filter(Boolean):[]},c=function(e,r){return e.some(function(e){return e.startsWith(r+".")})},u=function(e,r){for(var n={};e.length;){var s=e[0],a=s.code,o=s.message,i=s.path.join(".");if(!n[i]){if("unionErrors"in s){var c=s.unionErrors[0].errors[0];n[i]={message:c.message,type:c.code}}else n[i]={message:o,type:a}}if("unionErrors"in s&&s.unionErrors.forEach(function(r){return r.errors.forEach(function(r){return e.push(r)})}),r){var u=n[i].types,l=u&&u[s.code];n[i]=(0,t.KN)(i,r,n,a,l?[].concat(l,s.message):s.message)}e.shift()}return n},l=function(e,r,n){return void 0===n&&(n={}),function(t,s,i){try{return Promise.resolve(function(s,o){try{var c=Promise.resolve(e["sync"===n.mode?"parse":"parseAsync"](t,r)).then(function(e){return i.shouldUseNativeValidation&&a({},i),{errors:{},values:n.raw?t:e}})}catch(e){return o(e)}return c&&c.then?c.then(void 0,o):c}(0,function(e){if(null!=e.errors)return{values:{},errors:o(u(e.errors,!i.shouldUseNativeValidation&&"all"===i.criteriaMode),i)};throw e}))}catch(e){return Promise.reject(e)}}}}}]);